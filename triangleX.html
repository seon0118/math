<!DOCTYPE html>
<!-- saved from url=(0046)https://luhsinju.github.io/dapo_game/triangleX -->
<html lang="zh-TW"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TRIANGLE X 全等召喚</title>
  <script src="./TRIANGLE X 全等召喚_files/saved_resource"></script>
  <link href="./TRIANGLE X 全等召喚_files/css2" rel="stylesheet">
  <link href="./TRIANGLE X 全等召喚_files/css2(1)" rel="stylesheet">
  <link href="./TRIANGLE X 全等召喚_files/css2(2)" rel="stylesheet">
  <link href="./TRIANGLE X 全等召喚_files/css2(3)" rel="stylesheet">
  <link href="./TRIANGLE X 全等召喚_files/css2(4)" rel="stylesheet">
  <link href="./TRIANGLE X 全等召喚_files/css2(5)" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #0f1527 0%, #1a1033 100%);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%232d3d64' fill-opacity='0.1'%3E%3Cpath opacity='1' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    }
    @keyframes rgbAnimation {
      0% { 
        color: red; 
        text-shadow: 0 0 0 red, 0 0 10px orange, 0 0 20px yellow, 0 0 30px green, 0 0 40px blue, 0 0 50px indigo, 0 0 60px violet; 
      }
      14% { 
        color: orange; 
        text-shadow: 0 0 0 orange, 0 0 10px yellow, 0 0 20px green, 0 0 30px blue, 0 0 40px indigo, 0 0 50px violet, 0 0 60px red; 
      }
      28% { 
        color: yellow; 
        text-shadow: 0 0 0 yellow, 0 0 10px green, 0 0 20px blue, 0 0 30px indigo, 0 0 40px violet, 0 0 50px red, 0 0 60px orange; 
      }
      42% { 
        color: green; 
        text-shadow: 0 0 0 green, 0 0 10px blue, 0 0 20px indigo, 0 0 30px violet, 0 0 40px red, 0 0 50px orange, 0 0 60px yellow; 
      }
      57% { 
        color: blue; 
        text-shadow: 0 0 0 blue, 0 0 10px indigo, 0 0 20px violet, 0 0 30px red, 0 0 40px orange, 0 0 50px yellow, 0 0 60px green; 
      }
      71% { 
        color: indigo; 
        text-shadow: 0 0 0 indigo, 0 0 10px violet, 0 0 20px red, 0 0 30px orange, 0 0 40px yellow, 0 0 50px green, 0 0 60px blue; 
      }
      85% { 
        color: violet; 
        text-shadow: 0 0 0 violet, 0 0 10px red, 0 0 20px orange, 0 0 30px yellow, 0 0 40px green, 0 0 50px blue, 0 0 60px indigo; 
      }
      100% { 
        color: red; 
        text-shadow: 0 0 0 red, 0 0 10px orange, 0 0 20px yellow, 0 0 30px green, 0 0 40px blue, 0 0 50px indigo, 0 0 60px violet; 
      }
    }
  
    .rgb-text {
      animation: rgbAnimation 5s linear infinite;
      font-family: 'Audiowide', sans-serif;
      font-weight: bold;
    }

    .text-center.bg-white.rounded-lg.shadow-md, 
    .bg-white.rounded-lg.shadow-md {
      background: linear-gradient(135deg, rgba(13, 17, 23, 0.85) 0%, rgba(28, 25, 52, 0.85) 100%);
      border: 2px solid transparent;
      border-image: linear-gradient(to right, #ff00cc, #3333ff);
      border-image-slice: 1;
      box-shadow: 0 0 15px rgba(123, 97, 255, 0.4), 0 0 30px rgba(76, 0, 255, 0.1);
      backdrop-filter: blur(10px);
      color: white;
      clip-path: polygon(
        0% 10px,
        10px 0%,
        calc(100% - 10px) 0%,
        100% 10px,
        100% calc(100% - 10px),
        calc(100% - 10px) 100%,
        10px 100%,
        0% calc(100% - 10px)
      );
    }

    #question, #timer {
      color: #e2e8f0;
      text-shadow: 0 0 5px #6366f1;
    }

    #timer {
      color: #ff2d55;
      text-shadow: 0 0 10px #ff2d55;
    }

    canvas.bg-blue-50 {
      background: linear-gradient(145deg, rgba(10, 14, 32, 0.7) 0%, rgba(20, 30, 60, 0.7) 100%);
      border: 1px solid #4361ee !important;
      box-shadow: 0 0 10px rgba(67, 97, 238, 0.3);
    }

    button.bg-indigo-100 {
      background: linear-gradient(145deg, #121a36 0%, #2f1a7c 100%);
      color: white;
      border: 1px solid #4361ee;
      text-shadow: 0 0 5px rgba(123, 97, 255, 0.7);
      transition: all 0.3s ease;
    }

    button.bg-indigo-100:hover {
      background: linear-gradient(145deg, #2f1a7c 0%, #121a36 100%);
      box-shadow: 0 0 15px rgba(123, 97, 255, 0.7);
      transform: translateY(-2px);
    }

    #scoreA, #scoreB, #wrongA, #wrongB {
      text-shadow: 0 0 10px currentColor;
    }

    .player-section::before {
      content: '';
      position: absolute;
      top: -5px;
      left: -5px;
      right: -5px;
      bottom: -5px;
      border: 2px solid transparent;
      border-image: linear-gradient(45deg, #ff00cc, #3333ff);
      border-image-slice: 1;
      filter: blur(8px);
      z-index: -1;
    }

    #resultPage {
      z-index: 1000;
    }

    #resultPage .bg-white {
      background: linear-gradient(135deg, rgba(13, 17, 23, 0.85) 0%, rgba(28, 25, 52, 0.85) 100%);
      border: 2px solid transparent;
      border-image: linear-gradient(to right, #ff00cc, #3333ff);
      border-image-slice: 1;
      box-shadow: 0 0 15px rgba(123, 97, 255, 0.4);
    }

    #resultPage button {
      background: linear-gradient(145deg, #121a36 0%, #2f1a7c 100%);
      border: 1px solid #4361ee;
    }

    #resultPage button:hover {
      background: linear-gradient(145deg, #2f1a7c 0%, #121a36 100%);
      box-shadow: 0 0 15px rgba(123, 97, 255, 0.7);
    }
  </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.16 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.relative{position:relative}.inset-0{inset:0px}.mb-2{margin-bottom:0.5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mr-3{margin-right:0.75rem}.mt-2{margin-top:0.5rem}.mt-4{margin-top:1rem}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-24{height:6rem}.min-h-screen{min-height:100vh}.w-full{width:100%}.max-w-6xl{max-width:72rem}.max-w-7xl{max-width:80rem}.max-w-lg{max-width:32rem}.cursor-pointer{cursor:pointer}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-6{gap:1.5rem}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.space-y-6 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.overflow-y-auto{overflow-y:auto}.whitespace-pre-line{white-space:pre-line}.rounded{border-radius:0.25rem}.rounded-lg{border-radius:0.5rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-blue-200{--tw-border-opacity:1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-blue-50{--tw-bg-opacity:1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-indigo-100{--tw-bg-opacity:1;background-color:rgb(224 231 255 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-opacity-75{--tw-bg-opacity:0.75}.bg-gradient-to-br{background-image:linear-gradient(to bottom right, var(--tw-gradient-stops))}.from-blue-100{--tw-gradient-from:#dbeafe var(--tw-gradient-from-position);--tw-gradient-to:rgb(219 234 254 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-indigo-100{--tw-gradient-to:#e0e7ff var(--tw-gradient-to-position)}.p-1{padding:0.25rem}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-8{padding:2rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.pb-2{padding-bottom:0.5rem}.text-center{text-align:center}.font-sans{font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-indigo-700{--tw-text-opacity:1;color:rgb(67 56 202 / var(--tw-text-opacity, 1))}.text-indigo-800{--tw-text-opacity:1;color:rgb(55 48 163 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.shadow{--tw-shadow:0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:bg-indigo-300:hover{--tw-bg-opacity:1;background-color:rgb(165 180 252 / var(--tw-bg-opacity, 1))}@media (min-width: 768px){.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:grid-cols-5{grid-template-columns:repeat(5, minmax(0, 1fr))}}</style></head>

<body class="bg-gradient-to-br from-blue-100 to-indigo-100 min-h-screen flex flex-col items-center justify-start p-1 space-y-6 font-sans" style="background: black;">
  <!-- <div class="text-center p-1 w-full max-w-7xl">
    <div class="flex items-center mb-2" center>
      <img src="https://i.imgur.com/PH99mC3.png" alt="logo" width="200" height="200" class="mr-3" />
      <h1 class="text-4xl font-bold text-indigo-700 rgb-text" style="font-size: 48px;">TRIANGLE <span style="font-size: 70px;">X</span> 全等召喚</h1>
    </div>
  </div> -->
  <div class="text-center p-1 w-full max-w-6xl"></div>
    <div class="flex items-center mb-2" style="text-align: center;">
      <img src="./TRIANGLE X 全等召喚_files/PH99mC3.png" alt="logo" width="200" height="200" class="mr-3">
      <h1 class="text-4xl font-bold text-indigo-700 rgb-text" style="font-size: 48px;">TRIANGLE <span style="font-size: 70px;">X</span> 全等召喚</h1>
    </div>
    <!-- <h1 class="text-4xl font-bold mb-2 text-indigo-700"><img src="triangleX.png" alt="logo" width="50" height="50"/>Triangle X 全等召喚</h1> -->
    <!-- <div class="text-lg mb-2">題目：<span id="question" class="font-semibold text-indigo-800"></span></div>
    <div class="text-md">倒數計時：<span id="timer" class="font-bold text-red-600">05:00</span></div> -->
  
  <div class="text-center bg-white rounded-lg shadow-md p-4 w-full max-w-7xl">
    <div class="text-lg mb-2">題目：<span id="question" class="font-semibold text-indigo-800" style="font-size: 25px;">∠A=∠D 為直角, AB=DE, BC=EF</span></div>
    <div class="text-md">倒數計時：<span id="timer" class="font-bold text-red-600" style="font-size: 20px;">03:22</span></div>
  </div>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 w-full max-w-7xl">
    <!-- 玩家 A 區 -->
    <div class="bg-white rounded-lg shadow-md p-4 space-y-3">
      <div class="text-2xl text-md font-bold text-indigo-700 border-b pb-2" style="color: white;">玩家 A 得分：<span id="scoreA" class="text-indigo-700" style="color: white">0</span> <span style="float: right;">連續錯誤： <span id="wrongA" class="text-red-600 font-bold ">0</span></span></div>
      <div class="grid grid-cols-2 gap-3">
        <div class="relative">
          <canvas id="triangleA1" width="200" height="180" class="bg-blue-50 border border-blue-200 rounded cursor-pointer w-full"></canvas>
        </div>
        <div class="relative">
          <canvas id="triangleA2" width="200" height="180" class="bg-blue-50 border border-blue-200 rounded cursor-pointer w-full"></canvas>
        </div>
      </div>
      <div class="text-sm text-gray-700" style="display: none;">已選線索：<div id="logA" class="bg-gray-50 border rounded p-2 h-24 overflow-y-auto whitespace-pre-line text-sm"></div></div>
      
      <!-- 玩家A作答區 -->
      <div class="bg-gray-50 rounded-lg p-3 mt-2">
        <div class="mb-2 font-bold text-indigo-800">請選擇三角形全等的依據：</div>
        <div class="flex flex-wrap justify-center gap-2 mb-2">
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;A&#39;, &#39;SSS&#39;)">SSS</button>
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;A&#39;, &#39;SAS&#39;)">SAS</button>
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;A&#39;, &#39;ASA&#39;)">ASA</button>
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;A&#39;, &#39;AAS&#39;)">AAS</button>
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;A&#39;, &#39;RHS&#39;)">RHS</button>
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;A&#39;, &#39;NOT&#39;)">不一定</button>
        </div>
      </div>
      
      <div class="text-sm" id="statusA" style="display: none;">輪到你作答...</div>
    </div>

    <!-- 玩家 B 區 -->
    <div class="bg-white rounded-lg shadow-md p-4 space-y-3">
      <div class="text-2xl text-md font-bold text-indigo-700 border-b pb-2" style="color: white">玩家 B 得分：<span id="scoreB" class="text-indigo-700" style="color: white">0</span><span style="float: right;">連續錯誤： <span id="wrongB" class="text-red-600 font-bold ">0</span></span></div>
      <div class="grid grid-cols-2 gap-3">
        <div class="relative">
          <canvas id="triangleB1" width="200" height="180" class="bg-blue-50 border border-blue-200 rounded cursor-pointer w-full"></canvas>
        </div>
        <div class="relative">
          <canvas id="triangleB2" width="200" height="180" class="bg-blue-50 border border-blue-200 rounded cursor-pointer w-full"></canvas>
        </div>
      </div>
      <div class="text-sm text-gray-700" style="display: none;">已選線索：<div id="logB" class="bg-gray-50 border rounded p-2 h-24 overflow-y-auto whitespace-pre-line text-sm"></div></div>
      
      <!-- 玩家B作答區 -->
      <div class="bg-gray-50 rounded-lg p-3 mt-2">
        <div class="mb-2 font-bold text-indigo-800">請選擇三角形全等的依據：</div>
        <div class="flex flex-wrap justify-center gap-2 mb-2">
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;B&#39;, &#39;SSS&#39;)">SSS</button>
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;B&#39;, &#39;SAS&#39;)">SAS</button>
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;B&#39;, &#39;ASA&#39;)">ASA</button>
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;B&#39;, &#39;AAS&#39;)">AAS</button>
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;B&#39;, &#39;RHS&#39;)">RHS</button>
          <button class="bg-indigo-100 hover:bg-indigo-300 px-5 py-3 rounded shadow transition-colors text-sm" style="font-size:22px;" onclick="submitAnswer(&#39;B&#39;, &#39;NOT&#39;)">不一定</button>
        </div>
      </div>
      
      <div class="text-sm" id="statusB" style="display: none;">輪到你作答...</div>
    </div>
  </div>

  <div class="bg-white rounded-lg shadow-md p-4 w-full max-w-7xl mt-4">
    <div class="text-sm mb-2 font-bold">全等條件說明：</div>
    <div class="grid grid-cols-1 md:grid-cols-5 gap-2 text-xs text-gray-600" style="color: white">
      <div><span class="font-bold">SSS</span>：三邊對應相等</div>
      <div><span class="font-bold">SAS</span>：兩邊及其夾角對應相等</div>
      <div><span class="font-bold">ASA</span>：兩角及其夾邊對應相等</div>
      <div><span class="font-bold">AAS</span>：兩角及一非夾邊對應相等</div>
      <div><span class="font-bold">RHS</span>：直角、斜邊及一股對應相等</div>
    </div>
    <div class="mt-2 text-xs text-indigo-800 font-semibold" style="color: white">操作提示：點擊頂點選擇角度，點擊邊選擇邊長</div>
  </div>

  <!-- 結果頁面 -->
  <div id="resultPage" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center">
    <div class="text-center bg-white rounded-lg shadow-md p-8 max-w-lg">
      <h2 class="text-3xl font-bold text-indigo-700 mb-4">比賽結束！</h2>
      <p id="winnerText" class="text-xl text-white mb-6"></p>
      <button onclick="restartGame()" class="bg-indigo-100 hover:bg-indigo-300 px-6 py-3 rounded shadow transition-colors text-white text-lg">
        重新開始
      </button>
    </div>
  </div>

  <script>
    const questions = [
      // 不一定全等 AAA
      { known: '∠A=∠D, ∠B=∠E, ∠C=∠F', correct: 'NOT', shape: "general" },
      { known: '∠A=∠D, ∠C=∠F, ∠B=∠E', correct: 'NOT', shape: "general" },
      { known: '∠B=∠E, ∠A=∠D, ∠C=∠F', correct: 'NOT', shape: "general" },
      { known: '∠B=∠E, ∠C=∠F, ∠A=∠D', correct: 'NOT', shape: "general" },
      { known: '∠C=∠F, ∠A=∠D, ∠B=∠E', correct: 'NOT', shape: "general" },
      { known: '∠C=∠F, ∠B=∠E, ∠A=∠D', correct: 'NOT', shape: "general" },
      // 不一定全等 SSA
      { known: 'AB=DE, BC=EF, ∠A=∠D', correct: 'NOT', shape: "general" },
      { known: 'AB=DE, BC=EF, ∠C=∠F', correct: 'NOT', shape: "general" },

      // SSS 全等
      { known: 'AB=DE, BC=EF, AC=DF', correct: 'SSS', shape: "general" },
      { known: 'AB=DE, AC=DF, BC=EF', correct: 'SSS', shape: "general" },
      { known: 'BC=EF, AB=DE, AC=DF', correct: 'SSS', shape: "general" },
      { known: 'BC=EF, AC=DF, AB=DE', correct: 'SSS', shape: "general" },
      { known: 'AC=DF, AB=DE, BC=EF', correct: 'SSS', shape: "general" },
      { known: 'AC=DF, BC=EF, AB=DE', correct: 'SSS', shape: "general" },
      
      { known: 'AB=DE, BC=EF, AC=DF', correct: 'SSS', shape: "RHS" },
      { known: 'AB=DE, AC=DF, BC=EF', correct: 'SSS', shape: "RHS" },
      { known: 'BC=EF, AB=DE, AC=DF', correct: 'SSS', shape: "RHS" },
      { known: 'BC=EF, AC=DF, AB=DE', correct: 'SSS', shape: "RHS" },
      { known: 'AC=DF, AB=DE, BC=EF', correct: 'SSS', shape: "RHS" },
      { known: 'AC=DF, BC=EF, AB=DE', correct: 'SSS', shape: "RHS" },

      // SAS 全等
      { known: '∠A=∠D, AB=DE, AC=DF', correct: 'SAS', shape: "general" },
      { known: '∠A=∠D, AC=DF, AB=DE', correct: 'SAS', shape: "general" },
      { known: 'AB=DE, ∠A=∠D, AC=DF', correct: 'SAS', shape: "general" },
      { known: 'AB=DE, AC=DF, ∠A=∠D', correct: 'SAS', shape: "general" },
      { known: 'AC=DF, ∠A=∠D, AB=DE', correct: 'SAS', shape: "general" },
      { known: 'AC=DF, AB=DE, ∠A=∠D', correct: 'SAS', shape: "general" },

      { known: '∠A=∠D 為直角, AB=DE, AC=DF', correct: 'SAS', shape: 'RHS' },
      { known: '∠A=∠D 為直角, AC=DF, AB=DE', correct: 'SAS', shape: 'RHS' },
      { known: 'AB=DE, ∠A=∠D 為直角, AC=DF', correct: 'SAS', shape: 'RHS' },
      { known: 'AB=DE, AC=DF, ∠A=∠D 為直角', correct: 'SAS', shape: 'RHS' },
      { known: 'AC=DF, ∠A=∠D 為直角, AB=DE', correct: 'SAS', shape: 'RHS' },
      { known: 'AC=DF, AB=DE, ∠A=∠D 為直角', correct: 'SAS', shape: 'RHS' },

      { known: '∠B=∠E, AB=DE, BC=EF', correct: 'SAS', shape: "general" },
      { known: '∠B=∠E, BC=EF, AB=DE', correct: 'SAS', shape: "general" },
      { known: 'AB=DE, ∠B=∠E, BC=EF', correct: 'SAS', shape: "general" },
      { known: 'AB=DE, BC=EF, ∠B=∠E', correct: 'SAS', shape: "general" },
      { known: 'BC=EF, ∠B=∠E, AB=DE', correct: 'SAS', shape: "general" },
      { known: 'BC=EF, AB=DE, ∠B=∠E', correct: 'SAS', shape: "general" },

      { known: '∠C=∠F, BC=EF, AC=DF', correct: 'SAS', shape: "general" },
      { known: '∠C=∠F, AC=DF, BC=EF', correct: 'SAS', shape: "general" },
      { known: 'BC=EF, ∠C=∠F, AC=DF', correct: 'SAS', shape: "general" },
      { known: 'BC=EF, AC=DF, ∠C=∠F', correct: 'SAS', shape: "general" },
      { known: 'AC=DF, ∠C=∠F, BC=EF', correct: 'SAS', shape: "general" },
      { known: 'AC=DF, BC=EF, ∠C=∠F', correct: 'SAS', shape: "general" },

      // ASA 全等
      { known: '∠A=∠D, ∠B=∠E, AB=DE', correct: 'ASA', shape: "general" },
      { known: '∠A=∠D, AB=DE, ∠B=∠E', correct: 'ASA', shape: "general" },
      { known: '∠B=∠E, ∠A=∠D, AB=DE', correct: 'ASA', shape: "general" },
      { known: '∠B=∠E, AB=DE, ∠A=∠D', correct: 'ASA', shape: "general" },
      { known: 'AB=DE, ∠A=∠D, ∠B=∠E', correct: 'ASA', shape: "general" },
      { known: 'AB=DE, ∠B=∠E, ∠A=∠D', correct: 'ASA', shape: "general" },

      // { known: '∠A=∠D 為直角, ∠B=∠E, AB=DE', correct: 'ASA', shape: 'RHS' },
      // { known: '∠A=∠D 為直角, AB=DE, ∠B=∠E', correct: 'ASA', shape: 'RHS' },
      // { known: '∠B=∠E, ∠A=∠D 為直角, AB=DE', correct: 'ASA', shape: 'RHS' },
      // { known: '∠B=∠E, AB=DE, ∠A=∠D 為直角', correct: 'ASA', shape: 'RHS' },
      // { known: 'AB=DE, ∠A=∠D 為直角, ∠B=∠E', correct: 'ASA', shape: 'RHS' },
      // { known: 'AB=DE, ∠B=∠E, ∠A=∠D 為直角', correct: 'ASA', shape: 'RHS' },

      { known: '∠B=∠E, ∠C=∠F, BC=EF', correct: 'ASA', shape: "general" },
      { known: '∠B=∠E, BC=EF, ∠C=∠F', correct: 'ASA', shape: "general" },
      { known: '∠C=∠F, ∠B=∠E, BC=EF', correct: 'ASA', shape: "general" },
      { known: '∠C=∠F, BC=EF, ∠B=∠E', correct: 'ASA', shape: "general" },
      { known: 'BC=EF, ∠B=∠E, ∠C=∠F', correct: 'ASA', shape: "general" },
      { known: 'BC=EF, ∠C=∠F, ∠B=∠E', correct: 'ASA', shape: "general" },

      // { known: '∠C=∠F, ∠A=∠D, AC=DF', correct: 'ASA', shape: "general" },
      // { known: '∠C=∠F, AC=DF, ∠A=∠D', correct: 'ASA', shape: "general" },
      // { known: '∠A=∠D, ∠C=∠F, AC=DF', correct: 'ASA', shape: "general" },
      // { known: '∠A=∠D, AC=DF, ∠C=∠F', correct: 'ASA', shape: "general" },
      // { known: 'AC=DF, ∠C=∠F, ∠A=∠D', correct: 'ASA', shape: "general" },
      // { known: 'AC=DF, ∠A=∠D, ∠C=∠F', correct: 'ASA', shape: "general" },

      { known: '∠C=∠F, ∠A=∠D 為直角, AC=DF', correct: 'ASA', shape: 'RHS' },
      { known: '∠C=∠F, AC=DF, ∠A=∠D 為直角', correct: 'ASA', shape: 'RHS' },
      { known: '∠A=∠D 為直角, ∠C=∠F, AC=DF', correct: 'ASA', shape: 'RHS' },
      { known: '∠A=∠D 為直角, AC=DF, ∠C=∠F', correct: 'ASA', shape: 'RHS' },
      { known: 'AC=DF, ∠C=∠F, ∠A=∠D 為直角', correct: 'ASA', shape: 'RHS' },
      { known: 'AC=DF, ∠A=∠D 為直角, ∠C=∠F', correct: 'ASA', shape: 'RHS' },

      // AAS 全等
      { known: '∠A=∠D, ∠B=∠E, BC=EF', correct: 'AAS', shape: "general" },
      { known: '∠A=∠D, BC=EF, ∠B=∠E', correct: 'AAS', shape: "general" },
      { known: '∠B=∠E, ∠A=∠D, BC=EF', correct: 'AAS', shape: "general" },
      { known: '∠B=∠E, BC=EF, ∠A=∠D', correct: 'AAS', shape: "general" },
      { known: 'BC=EF, ∠A=∠D, ∠B=∠E', correct: 'AAS', shape: "general" },
      { known: 'BC=EF, ∠B=∠E, ∠A=∠D', correct: 'AAS', shape: "general" },

      // { known: '∠A=∠D, ∠B=∠E, AC=DF', correct: 'AAS', shape: "general" },
      // { known: '∠A=∠D, AC=DF, ∠B=∠E', correct: 'AAS', shape: "general" },
      // { known: '∠B=∠E, ∠A=∠D, AC=DF', correct: 'AAS', shape: "general" },
      // { known: '∠B=∠E, AC=DF, ∠A=∠D', correct: 'AAS', shape: "general" },
      // { known: 'AC=DF, ∠A=∠D, ∠B=∠E', correct: 'AAS', shape: "general" },
      // { known: 'AC=DF, ∠B=∠E, ∠A=∠D', correct: 'AAS', shape: "general" },

      { known: '∠B=∠E, ∠C=∠F, AB=DE', correct: 'AAS', shape: "general" },
      { known: '∠B=∠E, AB=DE, ∠C=∠F', correct: 'AAS', shape: "general" },
      { known: '∠C=∠F, ∠B=∠E, AB=DE', correct: 'AAS', shape: "general" },
      { known: '∠C=∠F, AB=DE, ∠B=∠E', correct: 'AAS', shape: "general" },
      { known: 'AB=DE, ∠B=∠E, ∠C=∠F', correct: 'AAS', shape: "general" },
      { known: 'AB=DE, ∠C=∠F, ∠B=∠E', correct: 'AAS', shape: "general" },

      // { known: '∠B=∠E, ∠C=∠F, AC=DF', correct: 'AAS', shape: "general" },
      // { known: '∠B=∠E, AC=DF, ∠C=∠F', correct: 'AAS', shape: "general" },
      // { known: '∠C=∠F, ∠B=∠E, AC=DF', correct: 'AAS', shape: "general" },
      // { known: '∠C=∠F, AC=DF, ∠B=∠E', correct: 'AAS', shape: "general" },
      // { known: 'AC=DF, ∠B=∠E, ∠C=∠F', correct: 'AAS', shape: "general" },
      // { known: 'AC=DF, ∠C=∠F, ∠B=∠E', correct: 'AAS', shape: "general" },

      { known: '∠A=∠D, ∠C=∠F, AB=DE', correct: 'AAS', shape: "general" },
      { known: '∠A=∠D, AB=DE, ∠C=∠F', correct: 'AAS', shape: "general" },
      { known: '∠C=∠F, ∠A=∠D, AB=DE', correct: 'AAS', shape: "general" },
      { known: '∠C=∠F, AB=DE, ∠A=∠D', correct: 'AAS', shape: "general" },
      { known: 'AB=DE, ∠A=∠D, ∠C=∠F', correct: 'AAS', shape: "general" },
      { known: 'AB=DE, ∠C=∠F, ∠A=∠D', correct: 'AAS', shape: "general" },

      // { known: '∠A=∠D, ∠C=∠F, BC=EF', correct: 'AAS', shape: "general" },
      // { known: '∠A=∠D, BC=EF, ∠C=∠F', correct: 'AAS', shape: "general" },
      // { known: '∠C=∠F, ∠A=∠D, BC=EF', correct: 'AAS', shape: "general" },
      // { known: '∠C=∠F, BC=EF, ∠A=∠D', correct: 'AAS', shape: "general" },
      // { known: 'BC=EF, ∠A=∠D, ∠C=∠F', correct: 'AAS', shape: "general" },
      // { known: 'BC=EF, ∠C=∠F, ∠A=∠D', correct: 'AAS', shape: "general" },

      // RHS 全等
      { known: '∠A=∠D 為直角, AB=DE, BC=EF', correct: 'RHS', shape: "RHS" },
      { known: '∠A=∠D 為直角, BC=EF, AB=DE', correct: 'RHS', shape: "RHS" },
      { known: 'AB=DE, ∠A=∠D 為直角, BC=EF', correct: 'RHS', shape: "RHS" },
      { known: 'AB=DE, BC=EF, ∠A=∠D 為直角', correct: 'RHS', shape: "RHS" },
      { known: 'BC=EF, ∠A=∠D 為直角, AB=DE', correct: 'RHS', shape: "RHS" },
      { known: 'BC=EF, AB=DE, ∠A=∠D 為直角', correct: 'RHS', shape: "RHS" },

      { known: '∠A=∠D 為直角, AC=DF, BC=EF', correct: 'RHS', shape: "RHS" },
      { known: '∠A=∠D 為直角, BC=EF, AC=DF', correct: 'RHS', shape: "RHS" },
      { known: 'AC=DF, ∠A=∠D 為直角, BC=EF', correct: 'RHS', shape: "RHS" },
      { known: 'AC=DF, BC=EF, ∠A=∠D 為直角', correct: 'RHS', shape: "RHS" },
      { known: 'BC=EF, ∠A=∠D 為直角, AC=DF', correct: 'RHS', shape: "RHS" },
      { known: 'BC=EF, AC=DF, ∠A=∠D 為直角', correct: 'RHS', shape: "RHS" }
    ];

    const easyquestions = [
      // SSS
      { known: 'AB=DE, BC=EF, AC=DF', correct: 'SSS', shape: "general" }, 
      // SAS
      { known: 'AB=DE, ∠A=∠D, AC=DF', correct: 'SAS', shape: "general" },
      { known: 'AB=DE, ∠B=∠E, BC=EF', correct: 'SAS', shape: "general" },
      { known: 'AC=DF, ∠C=∠F, BC=EF', correct: 'SAS', shape: "general" },
      // ASA
      { known: '∠A=∠D, AB=DE, ∠B=∠E', correct: 'ASA', shape: "general" },
      { known: '∠B=∠E, BC=EF, ∠C=∠F', correct: 'ASA', shape: "general" },
      { known: '∠A=∠D, AC=DF, ∠C=∠F', correct: 'ASA', shape: "general" },
      // AAS
      { known: '∠A=∠D, ∠B=∠E, BC=EF', correct: 'AAS', shape: "general" },
      { known: '∠B=∠E, ∠C=∠F, AB=DE', correct: 'AAS', shape: "general" },
      { known: '∠A=∠D, ∠C=∠F, AB=DE', correct: 'AAS', shape: "general" },
      // RHS
      { known: '∠A=∠D 為直角, AB=DE, BC=EF', correct: 'RHS', shape: "RHS" },
      { known: '∠A=∠D 為直角, AC=DF, BC=EF', correct: 'RHS', shape: "RHS" }
    ];
    let scoreA = 0;
    let scoreB = 0;
    let wrongA = 0;
    let wrongB = 0;
    let easyquestions_idx = 0;
    let currentQuestionIndex = Math.floor(Math.random() * easyquestions.length);
    let playerAnswers = { 'A': null, 'B': null };
    let selectedEdges = {
      triangleA1: {},
      triangleA2: {},
      triangleB1: {},
      triangleB2: {}
    };
    let selectedAngles = {
      triangleA1: {},
      triangleA2: {},
      triangleB1: {},
      triangleB2: {}
    };
    let timerInterval;

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]]; // 交換元素
      }
      return array;
    }

    function startGame() {
      scoreA = 0;
      scoreB = 0;
      wrongA = 0;
      wrongB = 0;
      shuffle(questions);
      shuffle(easyquestions);
      // console.log(questions); // 輸出打亂後的陣列
      currentQuestionIndex = 0; //Math.floor(Math.random() * easyquestions.length);
      playerAnswers = { 'A': null, 'B': null };
      selectedEdges = {
        triangleA1: {},
        triangleA2: {},
        triangleB1: {},
        triangleB2: {}
      };
      selectedAngles = {
        triangleA1: {},
        triangleA2: {},
        triangleB1: {},
        triangleB2: {}
      };
      document.getElementById('scoreA').innerText = scoreA;
      document.getElementById('scoreB').innerText = scoreB;
      document.getElementById('wrongA').innerText = wrongA;
      document.getElementById('wrongB').innerText = wrongB;
      document.getElementById('logA').innerText = '';
      document.getElementById('logB').innerText = '';
      document.getElementById('statusA').innerText = '輪到你作答...';
      document.getElementById('statusB').innerText = '輪到你作答...';
      document.getElementById('question').innerText = easyquestions[currentQuestionIndex].known;
      startTimer();
      drawTriangles();
      setupClickHandlers();
    }

    function submitAnswer(player, ans) {
      if (playerAnswers[player] !== null) {
        return;
      }
      
      playerAnswers[player] = ans;
      document.getElementById(`status${player}`).innerText = `已回答：${ans}`;

      let correct = questions[currentQuestionIndex].correct;
      if (easyquestions_idx <= 10) {
        correct = easyquestions[currentQuestionIndex].correct;
      }
      
      if (ans === correct) {
        if (player === 'A') {
          scoreA += 1;
          wrongA = 0;
          document.getElementById('scoreA').innerText = scoreA;
          document.getElementById('wrongA').innerText = wrongA;
          document.getElementById('scoreA').classList.add('text-green-600');
          setTimeout(() => document.getElementById('scoreA').classList.remove('text-green-600'), 1000);
        } else {
          scoreB += 1;
          wrongB = 0;
          document.getElementById('scoreB').innerText = scoreB;
          document.getElementById('wrongB').innerText = wrongB;
          document.getElementById('scoreB').classList.add('text-green-600');
          setTimeout(() => document.getElementById('scoreB').classList.remove('text-green-600'), 1000);
        }
      } else {
        if (player === 'A') {
          wrongA += 1;
          document.getElementById('wrongA').innerText = wrongA;
          document.getElementById('wrongA').classList.add('text-green-600');
          setTimeout(() => document.getElementById('wrongA').classList.remove('text-green-600'), 1000);
        } else {
          wrongB += 1;
          document.getElementById('wrongB').innerText = wrongB;
          document.getElementById('wrongB').classList.add('text-green-600');
          setTimeout(() => document.getElementById('wrongB').classList.remove('text-green-600'), 1000);
        }
        if (wrongA === 3) {
          endGame('B', '玩家 A 連續答錯三次');
          return;
        } else if (wrongB === 3) {
          endGame('A', '玩家 B 連續答錯三次');
          return;
        }
      }
      
      checkBothPlayersAnswered();
    }
    
    function checkBothPlayersAnswered() {
      if (playerAnswers['A'] !== null || playerAnswers['B'] !== null) {
        setTimeout(() => {
          resetGame();
        }, 100);
      }
    }

    function resetGame() {
      selectedEdges = {
        triangleA1: {},
        triangleA2: {},
        triangleB1: {},
        triangleB2: {}
      };
      selectedAngles = {
        triangleA1: {},
        triangleA2: {},
        triangleB1: {},
        triangleB2: {}
      };
      easyquestions_idx += 1;
      if (easyquestions_idx <= 10) {
        currentQuestionIndex = easyquestions_idx;// Math.floor(Math.random() * easyquestions.length);
        document.getElementById('question').innerText = easyquestions[currentQuestionIndex].known;
      } else {
        currentQuestionIndex = Math.floor(Math.random() * questions.length);
        document.getElementById('question').innerText = questions[currentQuestionIndex].known;
      }
      document.getElementById('logA').innerText = '';
      document.getElementById('logB').innerText = '';
      document.getElementById('statusA').innerText = '輪到你作答...';
      document.getElementById('statusB').innerText = '輪到你作答...';
      
      playerAnswers = { 'A': null, 'B': null };
      
      drawTriangles();
      setupClickHandlers();
    }

    function drawTriangles() {
      const triangles = [
        { id: 'triangleA1', labels: ['A', 'B', 'C'] },
        { id: 'triangleA2', labels: ['D', 'E', 'F'] },
        { id: 'triangleB1', labels: ['A', 'B', 'C'] },
        { id: 'triangleB2', labels: ['D', 'E', 'F'] },
      ];
      
      triangles.forEach(tri => {
        const canvas = document.getElementById(tri.id);
        canvas.width = canvas.offsetWidth * 0.8;
        canvas.height = canvas.offsetHeight * 0.8;
        
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        let points;
        if (easyquestions_idx <= 10) {
          if (easyquestions[currentQuestionIndex].shape === 'RHS') {
            points = [
              { x: 30, y: canvas.height - 30, label: tri.labels[0] },
              { x: canvas.width - 30, y: canvas.height - 30, label: tri.labels[1] },
              { x: 30, y: 30, label: tri.labels[2] }
            ];
          } else {
            points = [
              { x: 30, y: canvas.height - 30, label: tri.labels[0] },
              { x: canvas.width - 30, y: canvas.height - 30, label: tri.labels[1] },
              { x: canvas.width/2, y: 30, label: tri.labels[2] }
            ];
          }
        } else {
          if (questions[currentQuestionIndex].shape === 'RHS') {
            points = [
              { x: 30, y: canvas.height - 30, label: tri.labels[0] },
              { x: canvas.width - 30, y: canvas.height - 30, label: tri.labels[1] },
              { x: 30, y: 30, label: tri.labels[2] }
            ];
          } else {
            points = [
              { x: 30, y: canvas.height - 30, label: tri.labels[0] },
              { x: canvas.width - 30, y: canvas.height - 30, label: tri.labels[1] },
              { x: canvas.width/2, y: 30, label: tri.labels[2] }
            ];
          }
        }
        
        
        const angles = [
          {
            point: points[0],
            label: `∠${tri.labels[0]}`,
            adjacent: [points[2], points[1]]
          },
          {
            point: points[1],
            label: `∠${tri.labels[1]}`,
            adjacent: [points[0], points[2]]
          },
          {
            point: points[2],
            label: `∠${tri.labels[2]}`,
            adjacent: [points[1], points[0]]
          }
        ];

        canvas.triangleData = {
          points: points,
          angles: angles,
          edges: [
            { 
              points: [points[0], points[1]], 
              label: points[0].label + points[1].label,
              midpoint: { x: (points[0].x + points[1].x)/2, y: (points[0].y + points[1].y)/2 }
            },
            { 
              points: [points[1], points[2]], 
              label: points[1].label + points[2].label,
              midpoint: { x: (points[1].x + points[2].x)/2, y: (points[1].y + points[2].y)/2 }
            },
            { 
              points: [points[2], points[0]], 
              label: points[0].label + points[2].label,
              midpoint: { x: (points[2].x + points[0].x)/2, y: (points[2].y + points[0].y)/2 }
            }
          ]
        };
        
        drawTriangle(ctx, canvas.triangleData, tri.id);
      });
    }
    
    function drawTriangle(ctx, triangleData, canvasId) {
      const { points, edges, angles } = triangleData;
      ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
      
      const edgeColors = {
        'AB': '#6366F1',
        'BC': '#10B981',
        'AC': '#FFA500',
        'DE': '#6366F1',
        'EF': '#10B981',
        'DF': '#FFA500',
      };
      
      edges.forEach(edge => {
        ctx.beginPath();
        ctx.moveTo(edge.points[0].x, edge.points[0].y);
        ctx.lineTo(edge.points[1].x, edge.points[1].y);
        
        if (selectedEdges[canvasId] && selectedEdges[canvasId][edge.label]) {
          ctx.strokeStyle = edgeColors[edge.label] || '#6366F1';
          ctx.lineWidth = 3;
        } else {
          ctx.strokeStyle = 'white';
          ctx.lineWidth = 1.5;
        }
        
        ctx.stroke();
      });
      
      angles.forEach(angle => {
        const v1 = {
          x: angle.adjacent[0].x - angle.point.x,
          y: angle.adjacent[0].y - angle.point.y
        };
        const v2 = {
          x: angle.adjacent[1].x - angle.point.x,
          y: angle.adjacent[1].y - angle.point.y
        };
        
        const len1 = Math.sqrt(v1.x * v1.x + v1.y * v1.y);
        const len2 = Math.sqrt(v2.x * v2.x + v2.y * v2.y);
        
        const u1 = {
          x: v1.x / len1,
          y: v1.y / len1
        };
        const u2 = {
          x: v2.x / len2,
          y: v2.y / len2
        };
        
        const dot = u1.x * u2.x + u1.y * u2.y;
        const angleRad = Math.acos(Math.max(-1, Math.min(1, dot)));
        
        const angle1 = Math.atan2(v1.y, v1.x);
        const angle2 = Math.atan2(v2.y, v2.x);
        
        let startAngle = angle1;
        let endAngle = angle2;
        
        if (endAngle < startAngle) endAngle += 2 * Math.PI;
        
        const angleColors = {
          '∠A': '#EF4444',
          '∠B': '#8B5CF6',
          '∠C': '#EC4899',
          '∠D': '#EF4444',
          '∠E': '#8B5CF6',
          '∠F': '#EC4899'
        };
        
        if (selectedAngles[canvasId] && selectedAngles[canvasId][angle.label]) {
          const color = angleColors[angle.label] || '#6366F1';
          const radius = 25;
          ctx.beginPath();
          ctx.moveTo(angle.point.x, angle.point.y);
          ctx.arc(angle.point.x, angle.point.y, radius, startAngle, endAngle);
          ctx.closePath();
          ctx.fillStyle = `${color}33`;
          ctx.fill();
          
          ctx.beginPath();
          ctx.arc(angle.point.x, angle.point.y, radius, startAngle, endAngle);
          ctx.strokeStyle = color;
          ctx.lineWidth = 2;
          ctx.stroke();
        }
      });
      
      points.forEach((point, idx) => {
        ctx.beginPath();
        ctx.arc(point.x, point.y, 6, 0, Math.PI * 2);
        
        const vertexColors = {
          'A': '#EF4444',
          'B': '#8B5CF6',
          'C': '#EC4899',
          'D': '#EF4444',
          'E': '#8B5CF6',
          'F': '#EC4899'
        };
        
        const angleLabel = `∠${point.label}`;
        if (selectedAngles[canvasId] && selectedAngles[canvasId][angleLabel]) {
          ctx.fillStyle = vertexColors[point.label] || '#6366F1';
        } else {
          ctx.fillStyle = '#4B5563';
        }
        
        ctx.fill();
        
        ctx.fillStyle = 'white';
        ctx.font = '17px sans-serif';
        ctx.textAlign = 'center';
        if (point.label === 'C' || point.label === 'F') ctx.fillText(point.label, point.x, point.y - 10);
        else ctx.fillText(point.label, point.x, point.y + 20);
      });
    }

    function setupClickHandlers() {
      const playerMapping = {
        triangleA1: 'A',
        triangleA2: 'A',
        triangleB1: 'B',
        triangleB2: 'B'
      };
      
      const logs = {
        triangleA1: document.getElementById('logA'),
        triangleA2: document.getElementById('logA'),
        triangleB1: document.getElementById('logB'),
        triangleB2: document.getElementById('logB')
      };
      
      // 移除舊的事件監聽器
      Object.keys(logs).forEach(id => {
        const canvas = document.getElementById(id);
        // 創建一個新的畫布元素來替換舊的，以清除所有舊的事件監聽器
        const newCanvas = document.createElement('canvas');
        newCanvas.id = canvas.id;
        newCanvas.width = canvas.width;
        newCanvas.height = canvas.height;
        newCanvas.className = canvas.className;
        canvas.parentNode.replaceChild(newCanvas, canvas);
      });
      
      // 重新繪製三角形以確保新畫布有正確的內容
      drawTriangles();
      
      // 為新畫布綁定事件監聽器
      Object.keys(logs).forEach(id => {
        const canvas = document.getElementById(id);
        
        canvas.addEventListener('click', e => {
          const player = playerMapping[id];
          
          if (playerAnswers[player] !== null) {
            return;
          }
          
          const rect = canvas.getBoundingClientRect();
          const x = (e.clientX - rect.left) * (canvas.width / rect.width);
          const y = (e.clientY - rect.top) * (canvas.height / rect.height);
          
          const triangleData = canvas.triangleData;
          if (!triangleData) return;
          
          let clickedOnVertex = false;
          for (const angle of triangleData.angles) {
            const dist = Math.sqrt(
              Math.pow(x - angle.point.x, 2) + 
              Math.pow(y - angle.point.y, 2)
            );
            
            if (dist < 18) {
              clickedOnVertex = true;
              selectedAngles[id][angle.label] = !selectedAngles[id][angle.label];
              
              const ctx = canvas.getContext('2d');
              drawTriangle(ctx, triangleData, id);
              
              break;
            }
          }
          
          if (!clickedOnVertex) {
            for (const edge of triangleData.edges) {
              const dist = distanceToLine(
                x, y, 
                edge.points[0].x, edge.points[0].y, 
                edge.points[1].x, edge.points[1].y
              );
              
              if (dist < 18) {
                selectedEdges[id][edge.label] = !selectedEdges[id][edge.label];
                
                const ctx = canvas.getContext('2d');
                drawTriangle(ctx, triangleData, id);
                
                break;
              }
            }
          }
        });
      });
    }
    
    function distanceToLine(x, y, x1, y1, x2, y2) {
      const A = x - x1;
      const B = y - y1;
      const C = x2 - x1;
      const D = y2 - y1;
      
      const dot = A * C + B * D;
      const len_sq = C * C + D * D;
      let param = -1;
      
      if (len_sq != 0) param = dot / len_sq;
      
      let xx, yy;
      
      if (param < 0) {
        xx = x1;
        yy = y1;
      } else if (param > 1) {
        xx = x2;
        yy = y2;
      } else {
        xx = x1 + param * C;
        yy = y1 + param * D;
      }
      
      const dx = x - xx;
      const dy = y - yy;
      
      return Math.sqrt(dx * dx + dy * dy);
    }

    function startTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
      }
      
      let seconds = 3.5 * 60; // 4分鐘
      const timerElement = document.getElementById('timer');
      timerElement.classList.remove('animate-pulse');
      
      timerInterval = setInterval(() => {
        const min = String(Math.floor(seconds / 60)).padStart(2, '0');
        const sec = String(seconds % 60).padStart(2, '0');
        timerElement.textContent = `${min}:${sec}`;
        
        if (seconds <= 30) {
          timerElement.classList.add('animate-pulse');
        }
        
        seconds--;
        if (seconds < 0) {
          clearInterval(timerInterval);
          if (scoreA > scoreB) endGame('A', '時間到！分數較高');
          else if (scoreA < scoreB) endGame('B', '時間到！分數較高');
          else endGame(null, '時間到！');
        }
      }, 1000);
    }
    
    function endGame(winner, reason) {
      clearInterval(timerInterval);
      const message = winner ? `玩家 ${winner} 獲勝！\n原因：${reason}` : reason === '時間到！' ? '時間到！雙方平手！' : `平手！\n原因：${reason}`;
      
      document.getElementById('winnerText').innerText = `${message}\n玩家 A：${scoreA} 分\n玩家 B：${scoreB} 分`;
      document.getElementById('resultPage').classList.remove('hidden');
      
      document.querySelectorAll('body > div:not(#resultPage)').forEach(div => div.classList.add('hidden'));
    }

    function restartGame() {
      scoreA = 0;
      scoreB = 0;
      wrongA = 0;
      wrongB = 0;
      easyquestions_idx = 0;
      document.getElementById('scoreA').innerText = scoreA;
      document.getElementById('scoreB').innerText = scoreB;
      document.getElementById('wrongA').innerText = wrongA;
      document.getElementById('wrongB').innerText = wrongB;
      document.getElementById('timer').innerText = "03:30";
      document.getElementById('resultPage').classList.add('hidden');
      
      document.querySelectorAll('body > div:not(#resultPage)').forEach(div => div.classList.remove('hidden'));
      
      resetGame();
      startGame();
    }

    window.onload = startGame;
    window.addEventListener('resize', drawTriangles);
  </script>


</body></html>
