<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ•¸å­¸èŠ±åœ’ Pikmin Math Bloom</title>
    <link href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap" rel="stylesheet">
    <style>
        :root {
            --bloom-bg: #f5f7f9; /* ä¹¾æ·¨çš„ç°ç™½åº• */
            --bloom-ui: #ffffff;
            --primary-green: #8bc34a;
            --flower-pink: #f48fb1;
            --pikmin-red: #e53935;
            --pikmin-yellow: #fdd835;
            --pikmin-blue: #1e88e5;
            --text-dark: #37474f;
        }

        body {
            font-family: 'Varela Round', sans-serif;
            background-color: var(--bloom-bg);
            margin: 0;
            padding: 0;
            color: var(--text-dark);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            touch-action: none;
        }

        /* === é ‚éƒ¨è¨ˆæ­¥å™¨é¢¨æ ¼ HUD === */
        .header {
            width: 100%;
            background: var(--bloom-ui);
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-sizing: border-box;
            z-index: 10;
        }
        
        .step-counter {
            display: flex;
            flex-direction: column;
        }
        .step-label { font-size: 12px; color: #90a4ae; font-weight: bold; letter-spacing: 1px;}
        .step-value { font-size: 28px; font-weight: 900; color: var(--text-dark); }
        .step-icon { color: var(--flower-pink); margin-right: 5px; }

        .timer-badge {
            background: #eceff1;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            color: #546e7a;
        }

        /* === éŠæˆ²ç•«å¸ƒå€ === */
        .map-container {
            position: relative;
            flex-grow: 1;
            width: 100%;
            background: #fff; /* åœ°åœ–åº•è‰² */
            /* æ¨¡æ“¬åœ°åœ–ç¶²æ ¼ */
            background-image: 
                linear-gradient(#f0f0f0 1px, transparent 1px),
                linear-gradient(90deg, #f0f0f0 1px, transparent 1px);
            background-size: 20px 20px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        canvas {
            background: transparent;
        }

        /* === åº•éƒ¨æ“ä½œé¢æ¿ (æ¨¡ä»¿ App ä¸‹æ–¹é¸å–®) === */
        .control-dock {
            width: 100%;
            background: var(--bloom-ui);
            border-radius: 30px 30px 0 0;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.05);
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 20;
        }

        /* é¡Œç›®æŒ‡ç¤ºå¡ç‰‡ */
        .task-bubble {
            background: var(--primary-green);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            position: absolute;
            top: -20px;
            box-shadow: 0 4px 10px rgba(139, 195, 74, 0.4);
        }

        .equation-display {
            font-size: 24px;
            font-weight: 900;
            margin: 15px 0;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .var-highlight {
            background: #e3f2fd;
            color: #1565c0;
            padding: 2px 10px;
            border-radius: 8px;
            border: 2px dashed #90caf9;
        }

        /* LEVEL 1: èŠ±ç“£æŒ‰éˆ•éµç›¤ */
        #level1-controls { display: none; width: 100%; max-width: 400px; }
        
        .flower-keypad {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
        
        .petal-btn {
            background: #fce4ec; /* æ·ºç²‰ç´… */
            border: none;
            height: 50px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            color: #d81b60;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .petal-btn:active { transform: scale(0.95); background: #f8bbd0; }
        
        .btn-plant {
            grid-column: span 2;
            background: var(--primary-green);
            color: white;
            box-shadow: 0 4px #689f38;
        }
        .btn-plant:active { box-shadow: 0 0 #689f38; transform: translateY(4px); }

        /* LEVEL 2: æˆ°é¬¥å¡ç‰‡ */
        #level2-controls { display: none; width: 100%; flex-direction: column; gap: 10px;}
        
        .squad-card {
            background: white;
            border: 2px solid #eceff1;
            border-radius: 15px;
            padding: 15px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .squad-card:active { transform: scale(0.98); border-color: var(--text-dark); }
        .squad-icon {
            width: 40px; height: 40px;
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 20px;
            margin-right: 15px;
            color: white;
            font-weight: bold;
        }
        .squad-red { background: var(--pikmin-red); }
        .squad-yellow { background: var(--pikmin-yellow); }
        .squad-blue { background: var(--pikmin-blue); }
        
        .squad-info { font-size: 18px; font-weight: bold; color: var(--text-dark); }

        /* é®ç½©ç•«é¢ (æ¨¡ä»¿ App å•Ÿå‹•) */
        #overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.98);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            text-align: center;
        }
        
        .app-logo {
            width: 100px; height: 100px;
            background: var(--flower-pink);
            border-radius: 30px;
            display: flex; justify-content: center; align-items: center;
            font-size: 50px; color: white;
            margin-bottom: 20px;
            box-shadow: 0 10px 20px rgba(244, 143, 177, 0.4);
        }

        .btn-start {
            margin-top: 30px;
            padding: 15px 50px;
            font-size: 20px;
            font-weight: bold;
            color: white;
            background: var(--primary-green);
            border: none;
            border-radius: 50px;
            box-shadow: 0 5px 15px rgba(139, 195, 74, 0.4);
            cursor: pointer;
        }

        /* æµ®å‹•è¨Šæ¯ */
        .toast {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px 30px;
            border-radius: 30px;
            font-weight: bold;
            display: none;
            z-index: 50;
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="step-counter">
            <span class="step-label">TOTAL FLOWERS</span>
            <div style="display:flex; align-items:center;">
                <span class="step-icon">ğŸŒ¸</span>
                <span class="step-value" id="scoreDisplay">0</span>
            </div>
        </div>
        <div class="timer-badge">
            â± <span id="timeDisplay">--:--</span>
        </div>
    </div>

    <div class="map-container">
        <canvas id="gameCanvas" width="340" height="340"></canvas> <div class="toast" id="message"></div>
    </div>

    <div class="control-dock">
        <div class="task-bubble" id="levelLabel">æº–å‚™é–‹å§‹...</div>

        <div class="equation-display" id="questionArea">
            </div>

        <div id="level1-controls">
            <div class="flower-keypad">
                <button class="petal-btn" onclick="inputL1('1')">1</button>
                <button class="petal-btn" onclick="inputL1('2')">2</button>
                <button class="petal-btn" onclick="inputL1('3')">3</button>
                <button class="petal-btn" onclick="inputL1('-')">-</button>
                
                <button class="petal-btn" onclick="inputL1('4')">4</button>
                <button class="petal-btn" onclick="inputL1('5')">5</button>
                <button class="petal-btn" onclick="inputL1('6')">6</button>
                <button class="petal-btn" onclick="inputL1('C')">C</button>
                
                <button class="petal-btn" onclick="inputL1('7')">7</button>
                <button class="petal-btn" onclick="inputL1('8')">8</button>
                <button class="petal-btn" onclick="inputL1('9')">9</button>
                <button class="petal-btn" onclick="inputL1('0')">0</button>
                
                <button class="petal-btn btn-plant" id="btnPlant" onclick="submitL1()">ç¨®èŠ± Plant</button>
                <button class="petal-btn btn-plant" id="btnNextL1" onclick="nextQ1()" style="display:none; background:#29b6f6;">ç¹¼çºŒ Continue</button>
            </div>
        </div>

        <div id="level2-controls">
            <div style="font-size:14px; color:#78909c; margin-bottom:5px;">Select Squad (Equation)</div>
            <div class="squad-card" onclick="checkL2(0)">
                <div class="squad-icon squad-red">R</div>
                <div class="squad-info" id="opt0">y = 2x</div>
            </div>
            <div class="squad-card" onclick="checkL2(1)">
                <div class="squad-icon squad-yellow">Y</div>
                <div class="squad-info" id="opt1">y = x + 1</div>
            </div>
            <div class="squad-card" onclick="checkL2(2)">
                <div class="squad-icon squad-blue">B</div>
                <div class="squad-info" id="opt2">y = -x</div>
            </div>
            <button class="btn-start" id="btnNextL2" onclick="nextQ2()" style="display:none; width:100%; margin-top:0;">å°‹æ‰¾ä¸‹ä¸€å€‹è˜‘è‡</button>
        </div>
    </div>

    <div id="overlay">
        <div class="app-logo">P</div>
        <h1 style="color:#455a64; margin:0;">Pikmin<br>Math Bloom</h1>
        <p id="ov-desc" style="color:#90a4ae; margin-top:10px;">ä¸€èµ·æ•£æ­¥ç¨®èŠ±å­¸å‡½æ•¸å§ï¼</p>
        <button class="btn-start" id="startBtn" onclick="startLevel1()">Let's Walk!</button>
    </div>

<script>
    // --- è®Šæ•¸èˆ‡è¨­å®š ---
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const msg = document.getElementById('message');
    
    let scale = 20;
    let centerX = canvas.width / 2;
    let centerY = canvas.height / 2;
    
    let score = 0; // èŠ±æœµæ•¸é‡
    let timeLeft = 0;
    let timer = null;
    let level = 1;
    let isPlaying = false;
    let strikes = 0;

    // L1 Data
    let l1_m, l1_b, l1_x, l1_ans, l1_input = "";
    
    // L2 Data
    let l2_m, l2_b, l2_opts = [], l2_ansIdx = 0;

    // --- æ ¸å¿ƒé‚è¼¯ ---

    function startLevel1() {
        level = 1;
        score = 0;
        strikes = 0;
        timeLeft = 120; // 2åˆ†é˜
        
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('levelLabel').innerText = "LEVEL 1: æ•£æ­¥ç¨®èŠ±";
        document.getElementById('level1-controls').style.display = 'block';
        document.getElementById('level2-controls').style.display = 'none';
        
        isPlaying = true;
        startTimer(finishLevel1);
        nextQ1();
    }

    function finishLevel1() {
        isPlaying = false;
        clearInterval(timer);
        showOverlay("æ•£æ­¥çµæŸ", `ç¨®æ¤äº† ${score} æœµèŠ±ï¼\næº–å‚™å¥½å»æ‰“è˜‘è‡äº†å—ï¼Ÿ`, "Go Expedition", startLevel2);
    }

    function startLevel2() {
        level = 2;
        strikes = 0; // é‡ç½®å¤±èª¤
        timeLeft = 180; // 3åˆ†é˜
        
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('levelLabel').innerText = "LEVEL 2: è˜‘è‡æŒ‘æˆ°";
        document.getElementById('levelLabel').style.background = "#9c27b0"; // ç´«è‰²
        document.getElementById('level1-controls').style.display = 'none';
        document.getElementById('level2-controls').style.display = 'flex';
        
        isPlaying = true;
        startTimer(finishLevel2);
        nextQ2();
    }

    function finishLevel2() {
        isPlaying = false;
        clearInterval(timer);
        showOverlay("æ¯æ—¥å›é¡§", `ä½ ä»Šå¤©ç¨®äº† ${score} æœµèŠ±ï¼\nçœŸæ˜¯å……å¯¦çš„ä¸€å¤©ã€‚`, "æ˜å¤©è¦‹ (Restart)", () => location.reload());
    }

    function startTimer(callback) {
        if(timer) clearInterval(timer);
        updateUI();
        timer = setInterval(() => {
            if(!isPlaying) return;
            timeLeft--;
            updateUI();
            if(timeLeft <= 0) {
                callback();
            }
        }, 1000);
    }

    function showOverlay(title, desc, btnText, action) {
        document.getElementById('overlay').style.display = 'flex';
        document.querySelector('#overlay h1').innerText = title;
        document.querySelector('#ov-desc').innerText = desc;
        let btn = document.getElementById('startBtn');
        btn.innerText = btnText;
        btn.onclick = action;
    }

    function updateUI() {
        document.getElementById('scoreDisplay').innerText = score;
        let m = Math.floor(timeLeft / 60);
        let s = timeLeft % 60;
        document.getElementById('timeDisplay').innerText = `${m}:${s<10?'0':''}${s}`;
    }

    function showToast(text, color) {
        msg.innerText = text;
        msg.style.display = 'block';
        msg.style.background = color;
        setTimeout(() => msg.style.display = 'none', 1500);
    }

    // --- Level 1 Logic ---

    function nextQ1() {
        l1_input = "";
        document.getElementById('btnPlant').style.display = 'grid'; // span 2
        document.getElementById('btnNextL1').style.display = 'none';
        
        l1_m = Math.floor(Math.random() * 5) - 2; 
        if(l1_m===0) l1_m = 1; // é¿å…å¸¸æ•¸å‡½æ•¸å¤ªç„¡èŠ
        l1_b = Math.floor(Math.random() * 7) - 3;
        l1_x = Math.floor(Math.random() * 7) - 3;
        l1_ans = l1_m * l1_x + l1_b;

        // æ ¼å¼åŒ–é¡¯ç¤º
        let sign = l1_b >= 0 ? "+" : "-";
        let eq = `y = ${l1_m}x ${sign} ${Math.abs(l1_b)}`;
        if(l1_m===0) eq = `y = ${l1_b}`;
        else if(l1_m===1) eq = `y = x ${sign} ${Math.abs(l1_b)}`;
        else if(l1_m===-1) eq = `y = -x ${sign} ${Math.abs(l1_b)}`;
        else if(l1_b===0) eq = `y = ${l1_m}x`;

        document.getElementById('questionArea').innerHTML = 
            `<span>${eq}</span> <span style="font-size:16px; color:#aaa;">|</span> <span>x = ${l1_x}</span> <span style="font-size:16px; color:#aaa;">â†’</span> <div class="var-highlight" id="inputDisplay">?</div>`;

        drawL1Scene(null);
    }

    function inputL1(key) {
        if(!isPlaying || level !== 1) return;
        if(key === 'C') l1_input = "";
        else if(key === '-') {
            if(l1_input === "") l1_input = "-";
            else if(l1_input === "-") l1_input = "";
        } else {
            if(l1_input.length < 4) l1_input += key;
        }
        document.getElementById('inputDisplay').innerText = l1_input === "" ? "?" : l1_input;
    }

    function submitL1() {
        if(l1_input === "" || l1_input === "-") return;
        let val = parseInt(l1_input);
        
        let correct = (val === l1_ans);
        drawL1Scene(val, correct);

        if(correct) {
            score += 50; // ç¨®èŠ±çå‹µ
            showToast("Big Flower Bloomed!", "#8bc34a");
        } else {
            strikes++;
            showToast("Missed...", "#e53935");
            if(strikes >= 3) {
                isPlaying = false;
                setTimeout(() => showOverlay("é«”åŠ›è€—ç›¡", "çš®å…‹æ•ç´¯å£äº†...", "é‡è©¦", startLevel1), 1000);
                return;
            }
        }
        updateUI();
        
        document.getElementById('btnPlant').style.display = 'none';
        document.getElementById('btnNextL1').style.display = 'grid';
    }

    function drawL1Scene(userY, isCorrect) {
        ctx.clearRect(0,0,canvas.width, canvas.height);
        drawAxes();

        // ç•«å‡ºç›®æ¨™ X ç·š
        let px = centerX + l1_x * scale;
        ctx.strokeStyle = "rgba(0,0,0,0.1)";
        ctx.setLineDash([5,5]); ctx.beginPath(); ctx.moveTo(px, 0); ctx.lineTo(px, canvas.height); ctx.stroke(); ctx.setLineDash([]);

        // ç•«å‡ºçš®å…‹æ•ç¨®å­/åœ–ç¤º
        drawSeedling(px, centerY);

        if(userY !== null) {
            // ç•«ç·š
            ctx.beginPath();
            let x1 = -10, y1 = l1_m*x1+l1_b;
            let x2 = 10, y2 = l1_m*x2+l1_b;
            
            if(isCorrect) {
                // ç­”å°ï¼šç•«å‡ºç¨®æ»¿èŠ±çš„è·¯å¾‘
                ctx.strokeStyle = "rgba(139, 195, 74, 0.5)"; ctx.lineWidth = 10;
                ctx.moveTo(centerX+x1*scale, centerY-y1*scale);
                ctx.lineTo(centerX+x2*scale, centerY-y2*scale);
                ctx.stroke();
                
                // åœ¨æ­£ç¢ºé»ç•«å¤§èŠ±
                let py = centerY - l1_ans * scale;
                drawBigFlower(px, py);
                
                // æ²¿é€”ç•«å°èŠ±
                for(let i=0.2; i<0.8; i+=0.2) {
                    let mx = centerX + (x1 + (x2-x1)*i) * scale;
                    let my = centerY - (y1 + (y2-y1)*i) * scale;
                    drawSmallFlower(mx, my);
                }

            } else {
                // ç­”éŒ¯ï¼šç•«å‡ºéŒ¯èª¤è·¯å¾‘
                let py = centerY - userY * scale;
                ctx.strokeStyle = "#bdbdbd"; ctx.lineWidth = 2;
                ctx.beginPath(); ctx.moveTo(0, py); ctx.lineTo(px, py); ctx.stroke();
                // å¤±æ•—æ¨™è¨˜
                ctx.fillStyle = "#546e7a"; ctx.beginPath(); ctx.arc(px, py, 5, 0, Math.PI*2); ctx.fill();
            }
        }
    }

    // --- Level 2 Logic ---

    function nextQ2() {
        document.getElementById('questionArea').innerHTML = `<span>è§€å¯Ÿåœ–å½¢ âš”ï¸</span>`;
        document.getElementById('btnNextL2').style.display = 'none';
        let cards = document.querySelectorAll('.squad-card');
        cards.forEach(c => {
            c.style.opacity = "1";
            c.style.pointerEvents = "auto";
            c.style.borderColor = "#eceff1";
        });

        // é¡Œç›®ç”Ÿæˆ
        l2_m = Math.floor(Math.random() * 5) - 2; 
        l2_b = Math.floor(Math.random() * 5) - 2;
        
        let correctEq = formatEq(l2_m, l2_b);
        let w1, w2;
        
        do { w1 = formatEq(Math.floor(Math.random()*5)-2, Math.floor(Math.random()*5)-2); } while(w1===correctEq);
        do { w2 = formatEq(Math.floor(Math.random()*5)-2, Math.floor(Math.random()*5)-2); } while(w2===correctEq || w2===w1);

        l2_opts = [correctEq, w1, w2];
        l2_ansIdx = Math.floor(Math.random()*3);
        [l2_opts[0], l2_opts[l2_ansIdx]] = [l2_opts[l2_ansIdx], l2_opts[0]];

        // æ›´æ–°å¡ç‰‡æ–‡å­—
        document.getElementById('opt0').innerText = l2_opts[0];
        document.getElementById('opt1').innerText = l2_opts[1];
        document.getElementById('opt2').innerText = l2_opts[2];

        drawL2Scene(false);
    }

    function formatEq(m, b) {
        let sign = b >= 0 ? "+" : "-";
        if(m===0) return `y = ${b}`;
        if(m===1) return `y = x ${sign} ${Math.abs(b)}`;
        if(m===-1) return `y = -x ${sign} ${Math.abs(b)}`;
        if(b===0) return `y = ${m}x`;
        return `y = ${m}x ${sign} ${Math.abs(b)}`;
    }

    function checkL2(idx) {
        if(!isPlaying || level !== 2) return;
        
        let isCorrect = (idx === l2_ansIdx);
        drawL2Scene(true, isCorrect);

        // UI åé¥‹
        let cards = document.querySelectorAll('.squad-card');
        cards.forEach((c, i) => {
            c.style.pointerEvents = "none";
            if(i === idx) {
                c.style.borderColor = isCorrect ? "#8bc34a" : "#e53935";
                c.style.background = isCorrect ? "#f1f8e9" : "#ffebee";
            } else {
                c.style.opacity = "0.4";
            }
        });

        if(isCorrect) {
            score += 100; // è˜‘è‡é«˜åˆ†
            showToast("Mushroom Destroyed!", "#9c27b0");
        } else {
            strikes++;
            showToast("Defeated...", "#e53935");
            if(strikes >= 3) {
                isPlaying = false;
                setTimeout(() => showOverlay("ä»»å‹™å¤±æ•—", "éœ€è¦æ›´å¤šçš®å…‹æ•...", "é‡è©¦", startLevel2), 1000);
                return;
            }
        }
        updateUI();
        document.getElementById('btnNextL2').style.display = 'block';
    }

    function drawL2Scene(showResult, isCorrect) {
        ctx.clearRect(0,0,canvas.width, canvas.height);
        drawAxes();

        // ç•«è˜‘è‡ (ç›®æ¨™)
        let mx = 3; 
        let my = l2_m * mx + l2_b;
        if(Math.abs(my) > 7) { mx = -3; my = l2_m * mx + l2_b; } // ç¢ºä¿åœ¨ç•«é¢å…§
        
        let px = centerX + mx * scale;
        let py = centerY - my * scale;

        // ç•«ç·š (é¡Œç›®)
        ctx.beginPath();
        let x1 = -10, y1 = l2_m*x1+l2_b;
        let x2 = 10, y2 = l2_m*x2+l2_b;
        ctx.strokeStyle = "#455a64"; ctx.lineWidth = 4;
        ctx.moveTo(centerX+x1*scale, centerY-y1*scale);
        ctx.lineTo(centerX+x2*scale, centerY-y2*scale);
        ctx.stroke();

        // ç•«è˜‘è‡
        if(showResult && isCorrect) {
            // è˜‘è‡è¢«æ‰“æ•— (æ˜Ÿæ˜Ÿ)
            drawStars(px, py);
        } else {
            drawMushroom(px, py);
        }

        if(showResult && !isCorrect) {
            // é¡¯ç¤ºå•è™Ÿåœ¨é¸éŒ¯çš„åœ°æ–¹ (é€™è£¡ç°¡å–®ç¤ºæ„)
        }
    }


    // --- ç¹ªåœ–å…ƒä»¶ ---

    function drawAxes() {
        ctx.beginPath();
        ctx.strokeStyle = "#cfd8dc"; ctx.lineWidth = 2;
        ctx.moveTo(0, centerY); ctx.lineTo(canvas.width, centerY);
        ctx.moveTo(centerX, 0); ctx.lineTo(centerX, canvas.height);
        ctx.stroke();
    }

    function drawSeedling(x, y) {
        ctx.fillStyle = "#8bc34a"; // è‹—çš„é¡è‰²
        ctx.beginPath(); ctx.arc(x, y, 6, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.moveTo(x, y-6); ctx.lineTo(x, y-12); ctx.stroke();
    }

    function drawBigFlower(x, y) {
        ctx.save();
        ctx.translate(x, y-15);
        // èŠ±ç“£
        ctx.fillStyle = "#f48fb1";
        for(let i=0; i<5; i++) {
            ctx.beginPath();
            ctx.ellipse(0, 0, 8, 15, i*(Math.PI*2/5), 0, Math.PI*2);
            ctx.fill();
        }
        // èŠ±è•Š
        ctx.fillStyle = "#fdd835";
        ctx.beginPath(); ctx.arc(0, 0, 6, 0, Math.PI*2); ctx.fill();
        // è–
        ctx.restore();
        ctx.strokeStyle = "#8bc34a"; ctx.lineWidth=3;
        ctx.beginPath(); ctx.moveTo(x, y); ctx.lineTo(x, y-15); ctx.stroke();
    }

    function drawSmallFlower(x, y) {
        ctx.fillStyle = "#ffcdd2";
        ctx.beginPath(); ctx.arc(x, y, 4, 0, Math.PI*2); ctx.fill();
    }

    function drawMushroom(x, y) {
        ctx.save();
        ctx.translate(x, y);
        // èº«é«”
        ctx.fillStyle = "#eee";
        ctx.fillRect(-10, 0, 20, 20);
        // é ­
        ctx.fillStyle = "#ab47bc"; // ç´«è‰²è˜‘è‡
        ctx.beginPath(); ctx.arc(0, 0, 25, Math.PI, 0); ctx.fill();
        // é»é»
        ctx.fillStyle = "#e1bee7";
        ctx.beginPath(); ctx.arc(-10, -10, 5, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.arc(10, -5, 4, 0, Math.PI*2); ctx.fill();
        ctx.restore();
    }

    function drawStars(x, y) {
        ctx.fillStyle = "#fdd835";
        ctx.font = "20px Arial";
        ctx.fillText("âœ¨", x-10, y);
        ctx.fillText("âœ¨", x+10, y-10);
        ctx.fillText("âœ¨", x, y-20);
    }

</script>
</body>
</html>
